\documentclass[professionalfonts]{beamer}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{graphicx}
\usepackage{hyperref}
%\usepackage[plainpages=false, pdfpagelabels, colorlinks=true, linkcolor=black, menucolor=black, urlcolor=black, citecolor=black, pdftitle={Entwicklung eines Frameworks fuer die Verteilungsoptimierung in Publish/Subscribe Systemen auf Basis eines strukturierten P2P-Overlay Netzwerks}, pdfauthor={Johannes Held}, pdfsubject={Abschlussvortrag}, pdfkeywords={event dissemination, p2p-overlay network, publish/subscribe system, decentralized}]{hyperref}

\usepackage{multicol}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage[babel,german=quotes]{csquotes}

\usetheme{Malmoe}

\usecolortheme{crane}

\title[]{Entwicklung eines Frameworks für die Verteilungsoptimierung in Publish/Subscribe-Systemen auf Basis eines strukturierten P2P-Overlay-Netzwerks}
\author[Johannes Held]{Johannes Held\\\url{mailto:jo@ls6.informatik.uni-erlangen.de}}
\institute{Lehrstuhl für Informatik 6 (Datenmanagement)\\
Department Informatik\\
Technische Fakultät\\
Friedrich-Alexander-Universität Erlangen-Nürnberg}
\date{17.\,01.\,2011}

\subject{Abschlusspräsentation Diplomarbeit Johannes Held}
\keywords{event dissemination, p2p-overlay network, publish/subscribe system, decentralized}

\begin{document}


\frame[plain]{\titlepage}

\frame[plain]{
	\frametitle{Inhalt}
	\tableofcontents
}

\section{Einleitung}
\subsection*{Szenario}
\frame<1|handout:2>[label=szenario] {
	\frametitle{Szenario -- Quest in einem MMOG}
	\begin{block}{Finde drei Drachenklauen}
		Die Spielerin steuert ihren Avatar auf der Suche nach den Drachenklauen durch die virtuelle Welt. \only<2>{\alert{(Position)}}\\
		Bevor ihr Avatar diese aufnehmen kann, kommt es zum Kampf mit einem Gegner. \only<2>{\alert{(Kampf)}}\\
		Stolz, ihren ersten Kampf gewonnen zu haben, nimmt sie die Drachenklauen auf und berichtet davon ihn der Gilde. \only<2>{\alert{(Sprechen/ Gegenstand nehmen)}}\\
		Gewonnene Erfahrungspunkte: 500
	\end{block}
	
	\only<2|handout:0>{\hyperlink{eventtypen}{\beamerreturnbutton{Eventtypen und Events}}}
}

\frame<handout:0>[plain]{
	\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{%
	\includegraphics{grafics/kampf.jpg}}
	\end{figure}
	\tiny{ Warhammer Online: Age of Reckoning	\url{http://www.gameswelt.de/articles/previews/4833-Warhammer_Online/17777.html}}
}

\subsection*{Motivation}
\frame {
	\frametitle{Motivation}
	Ich will erzählen warum. Warum p2p, warum verteilt?
	
	\begin{block}{Kommunikation via Broadcast}
		\begin{itemize}
			\item Bandbreite Server 100 Mbit/s (12500 KB/s)
			\item Framerate 30 Hz (30 Updates/s)
			\item $n$ Knoten; je 10 Bytes pro Update
			\item $n$ · $0,3$ KB/s an Server	
			\item $\lfloor\sqrt{12500\,KB/s \div 0,3\,KB/s}\rfloor = 204$ Knoten
		\end{itemize}
	 \end{block}
}
	 
\frame {
	\frametitle{Motivation}
		 
	 \begin{block}{Was tun?}
	 	\begin{itemize}
	 		\item Sharding
	 		\item andere Kommunikationsstrategien
	 		\item \dots aber häufig nur beschränkte Optimierung
	 	\end{itemize}
	 \end{block}
	 
	 \pause
	 \begin{block}{M$^2$etis (Massive Multiuser Event InfraStructure)}
	 	 	\begin{itemize}
	 	 		\item Semantische Beschreibung der Eventtypen
	 	 		\begin{itemize}
	 	 		\item Optimierte Verteilung aller Events
	 	 		\end{itemize}
	 	 		\item Kommunikation via p2p
	 	 	\end{itemize}
	 \end{block}
}

\subsection*{Eventtypen und Events}
\frame[label=eventtypen]{
	\frametitle{Eventtypen und Events}
	\begin{columns}
		\column{.3\textwidth}
		\begin{block}{Eventtyp}
		\begin{itemize}
			\item Position
			\item Gegenstand nehmen
			\item Sprechen
		\end{itemize}
	\end{block}		
	\column{.61\textwidth}
		\begin{block}{Event}
		\begin{itemize}
			\item Spieler A ist an Position (x,y)
			\item Spieler A nimmt Schlüssel aus Truhe
			\item Spieler A sagt "Hallo" (zu Spieler B)
		\end{itemize}
		\end{block}
	\end{columns}
	
	\vspace{0.5cm}
	\visible<1|handout:0>{
		\hyperlink{szenario<2>}{
			\beamergotobutton{Szenario}
		}
	}
	
	
}

\section{M$^2$etis}
\subsection{Aufbau}
\frame<1>[plain,label=m2etis] {
	\frametitle{M$^2$etis -- Aufbau}
	
	%\only<1>{
	\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{%
	\includegraphics{grafics/metis_aufbau.pdf}}
	\end{figure}
	\begin{overprint}
	\onslide<2|handout:0>
	\hyperlink{open_points<3>}{\beamerreturnbutton{Offene Punkte}}
	\end{overprint}
	%}
	%\only<2>{
	%\begin{figure}[H]
	%\resizebox{0.9\textwidth}{!}{%
	%\includegraphics{grafics/metis_aufbau.pdf}}
	%\end{figure}

	%\begin{enumerate}
	%	\item Semantische Beschreibung der Eventtypen
	%	\item Generierung der optimierten Kanäle
	%	\item Benutzung des PubSubSytems
	%\end{enumerate}
	%}
}

\subsection{Klassifizierung von Eventtypen}
\frame {
	\frametitle{Klassifizierung von Eventtypen}
	\only<1|handout:0> {
		\begin{block}{Dimensionen}
			\begin{itemize}
				\item Kontext
				\item Synchronisation
				\item Persistenz
				\item Sicherheit
				\item Validität
				\item Zustellung
			\end{itemize}
		\end{block}		
	}
	\only<2-> {
	\begin{columns}[T]
		\column{.4\textwidth}
		\begin{block}{Dimensionen}
		\begin{itemize}
			\item Kontext
			\item Synchronisation
			\item Persistenz
			\item Sicherheit
			\item Validität
			\item Zustellung
		\end{itemize}
	\end{block}		
	\column{.6\textwidth}
		\only<2 | handout:1>{
		\begin{block}{Position}
		\begin{itemize}
			\item räumlicher Kontext
			\item keine Synchronisierung
			\item keine Abspeicherung
			\item keine Verschlüsselung
			\item begrenzt zeitlich valide
			\item ohne Zustellbenachrichtigung
		\end{itemize}
		\end{block}}
	\only<3 | handout:2>{
		\begin{block}{Gegenstand aufnehmen}
		\begin{itemize}
			\item globaler Kontext
			\item Synchronisierung
			\item Abspeicherung
			\item Verschlüsselung
			\item unbegrenzt zeitlich valide
			\item garantierte Zustellung
		\end{itemize}
		\end{block}}
	
	\end{columns} }
}

\frame{
	\frametitle{Ziel}
	\begin{block}{Verteilungsoptimierung der Nachrichten}
	Optimierte Verteilung aller Events anhand der semantischen Beschreibung der Eventtypen
	\end{block}
}

\section{Strukturierte p2p-Netzwerke}
\frame {
	\frametitle{Strukturierte p2p-Netzwerke}
	\begin{columns}
	\column{.5\textwidth}
	\begin{itemize}[<+->]
		\item	 Jedem Knoten wird anhand Hashfunktion ein Schlüssel aus dem Schlüsselraum zugewiesen.
		\item Jeder Knoten ist für einen Bereich aus diesem Schlüsselraum zuständig.
		\item Zuständiger Knoten für jedes \emph{Datum} berechenbar
	\end{itemize}
	\column{.5\textwidth}
	\pause
	\begin{figure}[H]
	\centering
	\resizebox{.8\textwidth}{!}{%
	\includegraphics{grafics/pastry_key_space.pdf}}
	\end{figure}
	\end{columns}
}
\subsection*{KBR-API}
\frame {
	\frametitle{KBR-API}
	\begin{block}{Abfragemethoden und drei Callbacks}
	\begin{description}
	\item[\texttt{update}] Knotenein- und austritt \\
		\small (KnotenID\&, bool) \normalsize
	\item[\texttt{forward}] Knoten leitet eine Nachricht weiter\\
		\small (EmpfängerID*, Nachricht*, NextHopID*) \normalsize \\
		\visible<2>{\alert{Alle Parameter sind veränderbar!}}
	\item[\texttt{deliver}] Knoten empfängt eine Nachricht \\
		\small (EmpfängerID\&, Nachricht\&) \normalsize
	\end{description}
	\end{block}
}	
\frame {
	\frametitle{KBR-API}
	Nachricht von $0x3f$ an $0x7b$ wird über $0x4a$ und $0x64$ gesendet.
	\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{%
	\includegraphics{grafics/routing_kbr.pdf}}
	\end{figure}
	
}

\subsection*{Multicast-Tree}
\frame{
	\frametitle{Multicast-Tree (verteiltes Publish/Subscribe)}
	\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{%
	\includegraphics{grafics/multicast_tree.pdf}}
	\end{figure}
	Ein Multicast-Tree pro Kanal.
}

\section{Konzeption des Publish/Subscribe-Systems}
\begin{frame}[fragile]
	\frametitle{Konzeption des Publish/Subscribe-Systems}
	\begin{itemize}
		\item 	kanalbasiertes Publish/Subscribe\\
		Mapping \emph{Eventtyp} $\leftrightarrow$ \emph{optimierter Kanal}
		\item 	transparent nutzbar \\ \emph{ohne} Wissen der Optimierungen (zur Übersetzungszeit)
	\end{itemize}
	
	\pause

	\begin{verbatim}
	subscribe(Kanal, Callback, Filter*)
	unsubscribe(Kanal)
	publish(Kanal, Nachricht)
	\end{verbatim}

\end{frame}

\subsection{Umsetzung der Dimensionen}
\frame {
	\frametitle{Umsetzung der Dimensionen}
	\begin{description}
	\item[Verteilung] bestimmt die Verteilungsart der einzelnen Events und den Aufbau des logischen Multicast-Trees, mittels dessen die Nachrichten versandt werden.
	\item[Filterung] erlaubt es Anmeldungen, Prädikate mitzugeben. Implementierungen dieser Policy müssen sicherstellen, dass diese Prädikate nach oben im Multicast-Tree zusammengeführt und Nachrichten frühzeitig gefiltert werden können. Dies bedeutet, dass Nachrichten jeweils beim Versand durch den logischen Kopf des Multicast-Trees gefiltert werden.
	\item[Zustellung] bestimmt das Kommunikationsparadigma des Nachrichtenversands und leitet beispielsweise den Versand von Bestätigungen über eingegangene Nachrichten an den sendenden Knoten ein.
	\item[Reihenfolge] definiert das Synchronisationskonzept eines Kanals.
	\item[Persistenz] bietet die Möglichkeit der Speicherung eines Events beziehungsweise der daraus erfolgenden Zustandsänderung der virtuellen Welt.
	\item[Sicherheit] gibt eine Schnittstelle zur Nachrichtenverschlüsselung vor.
	\item[Validität] prüft die ankommenden Nachrichten auf ihre Validität. Frühzeitig verworfene Nachrichten vermindern das Nachrichtenaufkommen im System stark.
	\end{description}
}

\subsection{Verarbeitungsmodell}
\frame {
	\frametitle{Verarbeitungsmodell}
	\begin{itemize}
		\item Mapping Publish/Subscribe auf KBR
		\item Versand einer Nachricht
		\item Verarbeitung einer Nachricht
		\pause
		\begin{itemize}
			\item \dots in \texttt{forward}
			\item \dots in \texttt{deliver}
		\end{itemize}
	\end{itemize}
}

\frame {
	\frametitle{Mapping Publish/Subscribe auf KBR}
	\begin{table}[!h]
\resizebox{\textwidth}{!}{%
\begin{tabular}{llccccccc}
\toprule
\multirow{2}{2cm}{Nachrichten\-typ} & \multirow{2}{2cm}{KBR-API Methode}	& \multicolumn{7}{c}{Policy pro Kanal} \\
\cmidrule{3-9}
			&	& Verteilung & Filterung & Zustellung & Reihenfolge & Persistenz & Sicherheit & Validität \\
\toprule 
Publish	    & \texttt{deliver} & + & + & + & + & + & + & + \\
\midrule
\multirow{2}{*}{Subscribe}	& \texttt{deliver} & + & + &   &   &   & + & \\
\cmidrule{2-9}
			& \texttt{forward} & + & + &   &   &   & + & \\
\midrule
\multirow{2}{*}{Unsubscribe} & \texttt{deliver} & + & + &   &   &   & + & \\
\cmidrule{2-9}
			& \texttt{forward} & + & + &   &   &   & + & \\
\bottomrule
\end{tabular}}
\end{table}

Verwaltung durch \{Un-\}Subscribe-Nachrichten\\
Events entsprechen Publish-Nachrichten

}

\frame {
	\frametitle{Nachrichtenversand}
	\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{%
	\includegraphics{grafics/processing_send.pdf}}
	\end{figure}
}
	
\frame {
	\frametitle{Verarbeitung in \texttt{forward}}
	\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{%
	\includegraphics{grafics/processing_forward.pdf}}
	\end{figure}
}
	
\frame[shrink,plain] {
	\frametitle{Verarbeitung in \texttt{deliver}}
	\begin{figure}[H]
	\centering
	\includegraphics{grafics/processing_deliver.pdf}
	\end{figure}
}

\section{Implementierung}
\frame{
	\frametitle{Implementierung}
	Klassenmodell\\
	Template-Metaprogrammierung\\
	
}

\frame[plain]{
	\frametitle{Vereinfachtes Klassenmodell}
	\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{%
	\includegraphics{grafics/uml.pdf}}
	\end{figure}
}


\frame{
	\frametitle{Template-Metaprogrammierung}
	\begin{itemize}
		\item Gewählte Strategien (pro Kanal) werden zur Übersetzungszeit eingewoben
		\item Nachrichtenheader (pro Kanal) wird zur Übersetzungszeit an gewählte Strategien angepasst
		\item Alle Kanäle zur Übersetzungszeit bekannt
		\item Lose Kopplung Netzwerk $\leftrightarrow$ Applikation
	\end{itemize}
}

\subsection*{Hindernisse}
\frame{
	\frametitle{Hindernisse bei der Implementierung}
	\only<1-2> {	
	\begin{block}{Knotenausfall wird nicht erkannt}
		\dots obwohl Chimera-Code den Versand einer Nachricht prüft
		\pause
		\begin{itemize}
			\item Chimera sendet Nachrichten mit UDP
			\item $\rightarrow$ Heartbeat-Mechanismus zur Erkennung
		\end{itemize}
	\end{block}
	}
	\only<3> {
	\begin{block}{Zusammenspiel PubSub-System und Netzwerk schwer prüfbar}
		\begin{itemize}
			\item Zu wenige Knoten $\rightarrow$ Fehlerhafte Einteilung in Routingtabellen
			\item Zu viele Knoten $\rightarrow$ Debug-Ausgaben nicht mehr erfassbar
		\end{itemize}		
	\end{block}
	}
}


\section{Offene Punkte}
\frame[label=open_points]{
	\frametitle{Offene Punkte}
	\begin{block}{Es fehlen noch \dots}
	\begin{itemize}[<+->]
		\pause
		\item Kostenmodell \& Semantische Beschreibung \& DSL
		\item Strategies, Strategies, Strategies \visible<1-|handout:0>{\hyperlink{m2etis<2>}{\beamergotobutton{M$^2$etis}}}
		\item M$^2$etis-Optimierer
		\item Simulator (bsp. OverSim)
		\item \dots
	\end{itemize}
	\end{block}
}

\section{Fragen?}
\frame{
	\frametitle{Fragen?}
	Gerne!\\
	\dots vielen Dank.
}

\frame[plain] {
}


\appendix
\againframe<2|handout:0>[plain]{szenario}
\againframe<2|handout:0>[plain]{m2etis}


\end{document}
